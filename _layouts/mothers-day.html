---
layout: default
---

<!-- example: http://127.0.0.1:4000/mothers-day?video=QV5pglqKDGQ -->
<div class="content-wrapper">
    <div class="envelope-shake-wrapper">
        <div class="envelope-wrapper">
            <div
                class="from-student-on-envelope"
                id="fromStudentOnEnvelope"
            ></div>
            <div class="lid one"></div>
            <div class="lid two"></div>
            <div class="envelope"></div>
            <div class="letter">
                <!-- Main Content Section (Initially Hidden) -->
                <section
                    id="mainContent"
                    class="wrapper pt-8 pt-md-12"
                    style="
                        display: none;
                        background: linear-gradient(
                            180deg,
                            #fff8f8 0%,
                            #ffffff 100%
                        );
                    "
                >
                    <div class="container pb-19 pb-md-20">
                        <!-- Decorative elements -->
                        <div
                            class="position-absolute"
                            style="top: 0; left: 5%; opacity: 0.1"
                        >
                            <i
                                class="uil uil-heart"
                                style="font-size: 4rem; color: #ff6b6b"
                            ></i>
                        </div>
                        <div
                            class="position-absolute"
                            style="top: 20%; right: 8%; opacity: 0.1"
                        >
                            <i
                                class="uil uil-flower"
                                style="font-size: 3rem; color: #ff6b6b"
                            ></i>
                        </div>
                        <div
                            class="position-absolute"
                            style="top: 30%; left: 10%; opacity: 0.1"
                        >
                            <i
                                class="uil uil-heart"
                                style="font-size: 3rem; color: #ff6b6b"
                            ></i>
                        </div>

                        <div class="row text-center">
                            <div class="col-md-10 col-xl-8 mx-auto">
                                <div class="post-header">
                                    <div class="mb-4">
                                        <i
                                            class="uil uil-heart-alt"
                                            style="
                                                font-size: 3rem;
                                                color: #ff6b6b;
                                            "
                                        ></i>
                                    </div>
                                    <h1
                                        class="display-1 mb-4"
                                        id="messageTitle"
                                    >
                                        {{
                                        site.data.mothers-day[page.locale].title
                                        }}
                                    </h1>
                                </div>
                            </div>
                        </div>

                        <div class="card-body text-left letterContent">
                            <div class="text-left">
                                <h3 class="h2 mb-4">
                                    {{
                                    site.data.mothers-day[page.locale].greeting
                                    }}
                                </h3>
                                <p class="mb-4" id="message1">
                                    {{
                                    site.data.mothers-day[page.locale].message_1
                                    }}
                                </p>
                                <p class="mb-4" id="message2">
                                    {{
                                    site.data.mothers-day[page.locale].message_2
                                    }}
                                </p>
                                <p class="mb-4" id="fromStudentSection"></p>
                            </div>
                        </div>
                    </div>
                </section>

                <section
                    id="videoSection"
                    class="wrapper"
                    style="display: none"
                >
                    <div class="container">
                        <div class="row">
                            <div class="col-lg-10 mx-auto" id="videoContainer">
                                <div class="blog single mt-n17">
                                    <div
                                        class="card"
                                        style="
                                            border-radius: 15px;
                                            box-shadow: 0 0 40px
                                                rgba(255, 107, 107, 0.1);
                                        "
                                    >
                                        <div
                                            style="
                                                position: relative;
                                                padding-bottom: 56.25%;
                                                height: 0;
                                                overflow: hidden;
                                                border-radius: 15px 15px 0 0;
                                            "
                                        >
                                            <video
                                                src="https://sharemyworks-projects.s3.us-west-1.amazonaws.com/data/users/5adbee4fee3da0002f416229/activities/5b1794092a7298001499ce6c/egg_timer_in_super_slow_motion_draining%20(1080p).mp4"
                                                id="videoPlayer"
                                                style="
                                                    position: absolute;
                                                    top: 0;
                                                    left: 0;
                                                    width: 100%;
                                                    height: 100%;
                                                    border: 0;
                                                    display: none;
                                                "
                                                controls
                                                allowfullscreen
                                            ></video>
                                            <iframe
                                                id="youtubeEmbed"
                                                style="
                                                    position: absolute;
                                                    top: 0;
                                                    left: 0;
                                                    width: 100%;
                                                    height: 100%;
                                                    border: 0;
                                                    display: none;
                                                "
                                                allowfullscreen
                                                frameborder="0"
                                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                                            >
                                            </iframe>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Social Media Share Buttons -->
                            <div
                                class="pt-10"
                                style="
                                    text-align: center;
                                    font-weight: 500;
                                    margin-bottom: 0.5rem;
                                    font-size: 1.2rem;
                                "
                            >
                                {{ site.data.mothers-day[page.locale].share }}
                            </div>
                            <div
                                class="social-share-row"
                                style="
                                    display: flex;
                                    justify-content: center;
                                    gap: 1.2rem;
                                    margin: 2rem auto;
                                "
                            >
                                <button
                                    type="button"
                                    class="social-icon"
                                    title="Copy Link"
                                    onclick="copyToClipboard()"
                                >
                                    <img
                                        src="/assets/img/icons/social/link.png"
                                        alt="Copy Link"
                                        style="width: 36px; height: 36px"
                                    />
                                </button>
                            </div>
                            <!-- <div
                                class="social-share-row"
                                style="
                                    display: flex;
                                    justify-content: center;
                                    gap: 1.2rem;
                                    margin: 2rem auto;
                                "
                            >
                                <button
                                    type="button"
                                    class="social-icon"
                                    title="WeChat"
                                    onclick="showWeChatQR()"
                                >
                                    <img
                                        src="/assets/img/icons/social/wechat.png"
                                        alt="WeChat"
                                        style="width: 36px; height: 36px"
                                    />
                                </button>
                            </div> -->
                        </div>
                    </div>
                </section>

                <!-- Subtle Promotional Button -->
                <div class="container pb-14 pb-md-16">
                    <div class="row">
                        <div class="col-lg-10 mx-auto">
                            <a
                                href="{% if page.locale == 'cn' %}/cn/free-trial{% else %}/free-trial{% endif %}"
                                style="
                                    background: #ffe4e1;
                                    padding: 1rem 2rem;
                                    border-radius: 12px;
                                    font-family: 'Arial', sans-serif;
                                    border: none;
                                    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
                                    color: #8b4513;
                                    font-weight: 500;
                                    transition: all 0.3s ease;
                                    cursor: pointer;
                                    display: block;
                                    margin: 2rem auto;
                                    width: auto;
                                    min-width: min-content;
                                    text-decoration: none;
                                    text-align: center;
                                "
                                onmouseover="this.style.background='#FFD1C9'; this.style.transform='translateY(-2px)'; this.style.boxShadow='0 4px 8px rgba(0,0,0,0.15)'"
                                onmouseout="this.style.background='#FFE4E1'; this.style.transform='none'; this.style.boxShadow='0 2px 4px rgba(0,0,0,0.1)'"
                            >
                                {{
                                site.data.mothers-day[page.locale].promo_message
                                }}
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.0/build/qrcode.min.js"></script>
<style>
    /* reference url: https://codepen.io/Coding-Star/pen/WNpbvwB */

    .letterContent {
        padding-left: 100px;
        padding-right: 100px;
    }

    .envelope-wrapper {
        height: 35vw;
        width: 70%;
        background-color: transparent;
        position: relative;
        display: flex;
        justify-content: center;
        z-index: 0;
        margin: 2rem auto;
        margin-top: 20vw;
        margin-bottom: 20vw;
        transition: margin 0.5s ease-in-out;
    }

    .lid {
        position: absolute;
        height: 0;
        width: 0;
        top: 0;
        left: 0;
        border-right: 35vw solid transparent;
        border-bottom: 17.5vw solid transparent;
        border-left: 35vw solid transparent;
        transform-origin: top;
        transition: transform 0.4s ease-in-out;
    }

    /* Lid when closed */
    .lid.one {
        border-top: 17.5vw solid #ffe4e1;
        transform: rotateX(0deg);
        z-index: 3;
        transition-delay: 0.4s;
    }

    /* Lid when opened */
    .lid.two {
        border-top: 17.5vw solid #ffd1c9;
        transform: rotateX(90deg);
        z-index: 1;
        transition-delay: 0.2s;
    }

    .envelope {
        position: absolute;
        height: 0;
        width: 0;
        top: 0;
        left: 0;
        border-top: 17.5vw solid transparent;
        border-right: 35vw solid #ffe4e1;
        border-bottom: 17.5vw solid #ffe4e1;
        border-left: 35vw solid #ffe4e1;
        z-index: 3;
        filter: drop-shadow(0 5px 15px rgba(0, 0, 0, 0.1));
    }

    .letter {
        position: absolute;
        top: 1vw;
        width: calc(70vw - 20px);
        height: 33vw;
        background-color: white;
        border-radius: 15px;
        z-index: 2;
        transition: all 0.5s ease-in-out;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        overflow: visible;
        overflow-y: scroll;
        margin-left: 1vw;
    }

    .envelope-wrapper.can-open.open .lid.one {
        transform: rotateX(90deg);
        transition-delay: 0s;
    }

    .envelope-wrapper.can-open.open .lid.two {
        transform: rotateX(180deg);
        transition-delay: 0.2s;
    }

    .envelope-wrapper.can-open.open {
        margin-top: 60vw;
    }

    .envelope-wrapper.can-open.open .letter {
        transform: translateY(-50vw);
        height: calc(
            50vw + 33vw
        ); /* 50vw is the height of the envelope, 33vw is the height of the letter, not 35vw to prevent overflow from the bottom of the envelope*/
        transition-delay: 0.5s;
        padding-bottom: 23vw;
    }

    @keyframes shake {
        0% {
            transform: rotate(0deg);
        }
        20% {
            transform: rotate(4deg);
        }
        40% {
            transform: rotate(-4deg);
        }
        60% {
            transform: rotate(4deg);
        }
        80% {
            transform: rotate(-4deg);
        }
        100% {
            transform: rotate(0deg);
        }
    }

    .envelope-shake-wrapper.shake {
        animation: shake 0.5s;
        animation-iteration-count: 2;
    }

    @media (max-width: 1024px) {
        .envelope-wrapper {
            width: 80%;
            height: 40vw;
        }

        .lid {
            border-right: 40vw solid transparent;
            border-bottom: 20vw solid transparent;
            border-left: 40vw solid transparent;
        }

        .lid.one {
            border-top: 20vw solid #ffe4e1;
        }

        .lid.two {
            border-top: 20vw solid #ffd1c9;
        }

        .envelope {
            border-top: 20vw solid transparent;
            border-right: 40vw solid #ffe4e1;
            border-bottom: 20vw solid #ffe4e1;
            border-left: 40vw solid #ffe4e1;
        }

        .letter {
            width: calc(80vw - 10px);
            height: calc(40vw - 10px);
        }

        .envelope-wrapper.can-open.open {
            margin-top: 60vw;
        }

        .envelope-wrapper.can-open.open .letter {
            transform: translateY(-50vw);
            height: calc(50vw + 37vw);
            transition-delay: 0.5s;
            padding-bottom: 30vw;
        }

        .letterContent {
            padding-left: 20px;
            padding-right: 20px;
        }
    }

    @media (max-width: 768px) {
        .envelope-wrapper {
            width: 90%;
            height: 50vw;
        }

        .lid {
            border-right: 45vw solid transparent;
            border-bottom: 25vw solid transparent;
            border-left: 45vw solid transparent;
        }

        .lid.one {
            border-top: 25vw solid #ffe4e1;
        }

        .lid.two {
            border-top: 25vw solid #ffd1c9;
        }

        .envelope {
            border-top: 25vw solid transparent;
            border-right: 45vw solid #ffe4e1;
            border-bottom: 25vw solid #ffe4e1;
            border-left: 45vw solid #ffe4e1;
        }

        .letter {
            width: calc(90vw - 30px);
            height: calc(50vw - 10px);
        }

        .envelope-wrapper.can-open.open {
            margin-top: 60vh;
        }

        .envelope-wrapper.can-open.open .letter {
            transform: translateY(-50vh);
            height: calc(50vh + 43vw);
            transition-delay: 0.5s;
            padding-bottom: 23vw;
        }

        .letterContent {
            padding-left: 10px;
            padding-right: 10px;
        }
    }

    @media (max-width: 480px) {
        .letterContent {
            padding-left: 5px;
            padding-right: 5px;
        }
    }

    .social-icon {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 48px;
        height: 48px;
        min-width: 48px;
        min-height: 48px;
        max-width: 48px;
        max-height: 48px;
        border-radius: 50%;
        color: #fff;
        font-size: 1.5rem;
        transition: transform 0.2s, box-shadow 0.2s, background 0.2s;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        cursor: pointer;
        outline: none;
        border: none;
        background: none;
        overflow: hidden;
        padding: 0;
    }

    .social-icon img {
        width: 60%;
        height: 60%;
        object-fit: contain;
        display: block;
        margin: 0 auto;
        pointer-events: none;
    }

    @media (max-width: 480px) {
        .social-icon,
        .social-icon img {
            width: 40px;
            height: 40px;
            min-width: 40px;
            min-height: 40px;
            max-width: 40px;
            max-height: 40px;
        }
        .social-icon img {
            width: 60%;
            height: 60%;
        }
    }

    .from-student-on-envelope {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        z-index: 10;
        font-size: 2.1rem;
        color: #b85c5c;
        font-family: "Great Vibes", "Pacifico", cursive, "Arial", sans-serif;
        font-weight: 400;
        text-align: center;
        pointer-events: none;
        width: 80%;
        line-height: 1.3;
        letter-spacing: 1.5px;
        text-shadow: 0 2px 8px rgba(255, 107, 107, 0.12), 0 1px 0 #fff;
        transition: opacity 0.4s;
        opacity: 1;
    }

    .envelope-wrapper.open .from-student-on-envelope {
        opacity: 0;
    }

    @media (max-width: 768px) {
        .from-student-on-envelope {
            font-size: 1.8rem;
        }
    }

    @media (max-width: 480px) {
        .from-student-on-envelope {
            font-size: 1.5rem;
        }
    }
</style>
<!-- Confetti CDN -->
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<script>
    const urlParams = new URLSearchParams(window.location.search);
    const projectId = urlParams.get("projectId");

    // const baseUrl = "http://localhost:3000/";
    const baseUrl = "https://backend4.sharemyworks.com/";
    if (projectId) {
        fetchUserData(projectId);
    }

    var fromMessage = "{{ site.data.mothers-day[page.locale].from_message }}";
    var from = "{{ site.data.mothers-day[page.locale].from }}";
    var clickHint = "{{ site.data.mothers-day[page.locale].click_hint }}";
    async function fetchUserData(projectId) {
        try {
            const studentName = await fetch(
                `${baseUrl}api/Activity/${projectId}/student`
            );
            const student = await studentName.json();
            // console.log(student);

            // console.log(student.firstName);
            // console.log(student.lastName);

            // Set the from message
            if (student.firstName || student.lastName) {
                const name = `${student.firstName ? student.firstName : ""}${
                    student.lastName ? " " + student.lastName : ""
                }`.trim();
                document.getElementById(
                    "fromStudentOnEnvelope"
                ).innerText = `${fromMessage}${name} \n ${clickHint}`;
                document.getElementById(
                    "fromStudentSection"
                ).innerText = `${from} ${name}`;
            }

            // console.log(
            //     `${baseUrl}api/Activity/${encodeURIComponent(projectId)}`
            // );
            const response = await fetch(
                `${baseUrl}api/Activity/${encodeURIComponent(projectId)}`
            );
            if (!response.ok) {
                throw new Error("Failed to fetch data");
            }
            const data = await response.json();

            // console.log(data);

            // if (data.type !== "mothers-day-project") {
            //     alert("Invalid project type");
            //     return;
            // }
            let hasVideo = false;
            if (data.videoUrl == "") {
                // loading video from s3
                const videos = await fetch(
                    `${baseUrl}api/Activity/${encodeURIComponent(
                        projectId
                    )}/getVideos`
                );
                const videosData = await videos.json();
                if (videosData.videos.length > 0) {
                    hasVideo = true;
                    const video = videosData.videos[0].s3Link;
                    console.log(video);
                    document.getElementById("videoPlayer").src = video;
                    document.getElementById("videoPlayer").style.display =
                        "block";
                    document.getElementById("youtubeEmbed").style.display =
                        "none";
                }
            } else {
                // parsing youtube url
                const videoLink = data.videoUrl;
                function extractYouTubeId(url) {
                    // Handles both youtu.be and youtube.com/watch?v= formats
                    const regExp =
                        /(?:youtube\.com\/.*v=|youtu\.be\/)([^&?/]+)/;
                    const match = url.match(regExp);
                    return match ? match[1] : null;
                }
                const videoId = extractYouTubeId(videoLink);
                if (videoId) {
                    hasVideo = true;
                    document.getElementById(
                        "youtubeEmbed"
                    ).src = `https://www.youtube.com/embed/${videoId}`;
                    document.getElementById("youtubeEmbed").style.display =
                        "block";
                    document.getElementById("videoPlayer").style.display =
                        "none";
                } else {
                    alert("Invalid YouTube URL");
                }
            }

            if (!hasVideo) {
                document.getElementById("videoContainer").style.display =
                    "none";
            }

            if (data.description) {
                document.getElementById("message1").innerText =
                    data.description;
            }

            document.getElementById("mainContent").style.display = "flex";
            document.getElementById("videoSection").style.display = "block";
            document
                .querySelector(".envelope-wrapper")
                .classList.add("can-open");

            let canonicalLink = document.querySelector('link[rel="canonical"]');
            if (!canonicalLink) {
                canonicalLink = document.createElement("link");
                canonicalLink.rel = "canonical";
                document.head.appendChild(canonicalLink);
            }
            canonicalLink.href = window.location.href;
        } catch (error) {
            alert("Error fetching data. Please try again.");
            console.error("Error:", error);
        }
    }

    function copyToClipboard() {
        const text = window.location.href;
        // navigator.share({ url: text }).catch(() => {});
        if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard
                .writeText(text)
                .then(() => {
                    if (navigator.share) {
                        navigator.share({ url: text }).catch(() => {});
                    }
                    alert("Copied to clipboard");
                })
                .catch(() => {
                    fallbackCopy(text);
                });
        } else {
            fallbackCopy(text);
        }
    }

    function fallbackCopy(text) {
        // Create a temporary textarea to select and copy
        const textarea = document.createElement("textarea");
        textarea.value = text;
        document.body.appendChild(textarea);
        textarea.select();
        try {
            document.execCommand("copy");
            alert("Copied to clipboard");
        } catch (err) {
            alert("Please copy the link manually: " + text);
        }
        document.body.removeChild(textarea);
    }

    function triggerEnvelopeShake() {
        const shakeWrapper = document.querySelector(".envelope-shake-wrapper");
        const env = document.querySelector(".envelope-wrapper");
        if (!env.classList.contains("can-open")) {
            shakeWrapper.classList.add("shake");
            setTimeout(() => {
                shakeWrapper.classList.remove("shake");
            }, 1000); // slightly longer than animation
        }
    }

    document.addEventListener("DOMContentLoaded", function () {
        const env = document.querySelector(".envelope-wrapper");
        env.addEventListener("click", function () {
            if (
                env.classList.contains("can-open") &&
                !env.classList.contains("open")
            ) {
                env.classList.add("open");
                // Fire confetti when opening
                if (window.confetti) {
                    confetti({
                        particleCount: 120,
                        spread: 80,
                        origin: { y: 0.5 },
                    });
                    setTimeout(() => {
                        confetti({
                            particleCount: 80,
                            spread: 60,
                            origin: { y: 0.7 },
                        });
                    }, 300);
                }
            } else if (!env.classList.contains("can-open")) {
                triggerEnvelopeShake();
            }
        });
    });

    // function shareOnFacebook(event) {
    //     event.preventDefault();
    //     const url = encodeURIComponent(window.location.href);
    //     window.open(
    //         `https://www.facebook.com/sharer/sharer.php?u=${url}`,
    //         "_blank",
    //         "width=600,height=400"
    //     );
    // }

    async function setupWeChat() {
        try {
            const currentUrl = window.location.href;
            const resp = await fetch(
                `https://wechat-signature-server.onrender.com/wechat-signature?url=${encodeURIComponent(
                    currentUrl
                )}`
            );
            const config = await resp.json();

            wx.config({
                debug: false,
                appId: config.appId,
                timestamp: config.timestamp,
                nonceStr: config.nonceStr,
                signature: config.signature,
                jsApiList: [
                    "updateAppMessageShareData",
                    "updateTimelineShareData",
                ],
            });

            wx.ready(() => {
                const shareData = {
                    title: "{{ site.data.mothers-day[page.locale].share_title }}",
                    desc: "{{ site.data.mothers-day[page.locale].share_description }}",
                    link: currentUrl,
                    imgUrl: "https://codingmind.com/assets/img/og-image.png",
                };

                wx.updateAppMessageShareData(shareData); // share to friends
                wx.updateTimelineShareData(shareData); // share to timeline
            });

            wx.error((err) => {
                console.error("WeChat config error:", err);
            });
        } catch (error) {
            console.error("WeChat config error:", error);
        }
    }

    setupWeChat();
</script>
